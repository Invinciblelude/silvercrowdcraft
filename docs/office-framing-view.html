<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>728 Cordant â€“ Office Framing vs Blueprint</title>
  <script src="auth.js"></script>
  <script src="assets/shared-nav.js?v=3"></script>
  <style>
    body {background:#0a0e27; color:#e8eef5; font-family:system-ui,-apple-system,sans-serif; margin:0}
    .container {max-width:1600px; margin:0 auto; padding:20px 20px 120px}
    .hero {background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); border-radius:16px; padding:24px; margin-bottom:20px}
    .hero h1 {margin:0 0 8px; font-size:28px; color:#fff}
    .grid {display:grid; grid-template-columns:520px 1fr; gap:20px}
    .panel {background:#12161b; border:2px solid #1f2630; border-radius:12px; padding:14px}
    .img {width:100%; height:auto; display:block; border:2px solid #667eea; border-radius:8px}
    .tabs {display:flex; gap:8px; margin-bottom:10px; flex-wrap:wrap}
    .tab {background:#1f2630; color:#9cc1ff; border:1px solid #273042; border-radius:8px; padding:8px 12px; cursor:pointer; font-weight:700}
    .tab.active {background:#667eea; color:#fff}
    svg {width:100%; height:auto}
    .legend {display:grid; grid-template-columns:repeat(auto-fit,minmax(210px,1fr)); gap:10px; margin-top:10px}
    .legend-item {display:flex; align-items:center; gap:8px; background:#0f1318; border-radius:8px; padding:8px}
    .sw {width:16px; height:16px; border-radius:3px; border:2px solid #1f2630}
  </style>
</head>
<body data-jsdom-page="office-framing-view" data-jsdom-title="ðŸ§± Office Framing vs Blueprint">
  <div class="container">
    <div class="hero">
      <h1>Office â€“ Blueprint (Sheet 07) vs Framing Elevations</h1>
      <p>Room: 12'-8" (152") x 11'-4" (136"). Studs @ 16" O.C., plates 2x6, wall height 8'-0". Door 3'-0" on East; Window 4'-0" x 4'-0" on North.</p>
    </div>

    <div class="grid">
      <div class="panel">
        <h3 style="margin:0 0 8px; color:#9cc1ff">Blueprint Reference (Floor Plan)</h3>
        <img class="img" src="../blueprints/classified/ARCH/07-Proposed-FloorPlan.jpg" alt="Sheet 07 â€“ Floor Plan">
        <p style="color:#8a98ab; font-size:12px; margin-top:8px">Use this as the reference. Framing diagrams on the right show each side (elevation view) for the Office room.</p>
      </div>

      <div class="panel">
        <div class="tabs">
          <button class="tab active" data-side="N">North</button>
          <button class="tab" data-side="S">South</button>
          <button class="tab" data-side="E">East</button>
          <button class="tab" data-side="W">West</button>
        </div>
        <div id="draw"></div>
        <div class="legend">
          <div class="legend-item"><span class="sw" style="background:#fb923c"></span><div>Bottom plate (2x6 PT)</div></div>
          <div class="legend-item"><span class="sw" style="background:#ef4444"></span><div>Double top plates (2x6)</div></div>
          <div class="legend-item"><span class="sw" style="background:#fbbf24"></span><div>Studs @ 16" O.C. (2x6)</div></div>
          <div class="legend-item"><span class="sw" style="background:#60a5fa"></span><div>King studs (full height)</div></div>
          <div class="legend-item"><span class="sw" style="background:#a78bfa"></span><div>Jack studs (to header)</div></div>
          <div class="legend-item"><span class="sw" style="background:#22c55e"></span><div>Header over opening</div></div>
          <div class="legend-item"><span class="sw" style="background:#f59e0b"></span><div>Sill (window)</div></div>
          <div class="legend-item"><span class="sw" style="background:#fcd34d"></span><div>Cripple studs</div></div>
          <div class="legend-item"><span class="sw" style="background:#67b7d1"></span><div>Window opening (RO)</div></div>
          <div class="legend-item"><span class="sw" style="background:#c084fc"></span><div>Door opening (RO)</div></div>
          <div class="legend-item"><span class="sw" style="background:#ef4444"></span><div>Anchor bolts (visualized)</div></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Geometry (inches)
    const L = 152, W = 136, H = 96; // span lengths and wall height
    const studsOC = 16; // O.C. spacing

    // Per-side definitions
    const sides = {
      N: { span: L, window: { from: 48, width: 48, height: 48, sill: 36 } },
      S: { span: L },
      E: { span: W, door: { from: 'center', width: 36, height: 80 } },
      W: { span: W }
    };

    const drawRoot = document.getElementById('draw');

    function drawSide(sideKey){
      const s = sides[sideKey];
      const width = 980, height = 460, margin = 60;
      const pxPerIn = (width - margin*2) / s.span; // 1D scale
      const vScale = pxPerIn; // vertical scale same as horizontal for proportion
      const svgns = 'http://www.w3.org/2000/svg';

      drawRoot.innerHTML = '';
      const svg = document.createElementNS(svgns, 'svg');
      svg.setAttribute('viewBox', `0 0 ${width} ${height}`);
      svg.style.width = '100%';

      const bg = document.createElementNS(svgns, 'rect');
      bg.setAttribute('x', 0); bg.setAttribute('y', 0); bg.setAttribute('width', width); bg.setAttribute('height', height); bg.setAttribute('fill', '#0f1318');
      svg.appendChild(bg);

      const baseY = height - margin; // bottom line
      const leftX = margin; const rightX = width - margin;
      const wallHeightPx = H * vScale;

      // Bottom plate (10 px)
      const bp = document.createElementNS(svgns, 'rect');
      bp.setAttribute('x', leftX); bp.setAttribute('y', baseY - 10);
      bp.setAttribute('width', s.span * pxPerIn); bp.setAttribute('height', 10);
      bp.setAttribute('fill', '#fb923c'); svg.appendChild(bp);

      // Top plates (double, 6 px each)
      const tp1Y = baseY - wallHeightPx - 6;
      const tp1 = document.createElementNS(svgns,'rect');
      tp1.setAttribute('x', leftX); tp1.setAttribute('y', tp1Y);
      tp1.setAttribute('width', s.span * pxPerIn); tp1.setAttribute('height', 6); tp1.setAttribute('fill','#ef4444'); svg.appendChild(tp1);
      const tp2 = document.createElementNS(svgns,'rect');
      tp2.setAttribute('x', leftX); tp2.setAttribute('y', tp1Y - 8);
      tp2.setAttribute('width', s.span * pxPerIn); tp2.setAttribute('height', 6); tp2.setAttribute('fill','#ef4444'); svg.appendChild(tp2);

      // Helper to draw a stud
      function stud(xCenter, yTop, heightPx, color){
        const r = document.createElementNS(svgns,'rect');
        r.setAttribute('x', xCenter - 3); r.setAttribute('y', yTop);
        r.setAttribute('width', 6); r.setAttribute('height', heightPx);
        r.setAttribute('fill', color); svg.appendChild(r);
      }

      // Regular studs @ 16" O.C. (avoid where kings/jacks go later)
      const studXs = new Set();
      for(let pos=0; pos<=s.span; pos+=studsOC){
        const x = leftX + pos*pxPerIn; if(x>rightX) break; studXs.add(Math.round(x));
      }

      // Openings placement and framing components
      const openings = [];
      if(s.window){
        openings.push({kind:'window', from:s.window.from, width:s.window.width, height:s.window.height, sill:s.window.sill});
      }
      if(s.door){
        const from = s.door.from === 'center' ? (s.span/2 - s.door.width/2) : s.door.from;
        openings.push({kind:'door', from, width:s.door.width, height:s.door.height});
      }

      // Draw openings and special studs
      openings.forEach(op => {
        const x0 = leftX + op.from*pxPerIn;
        const x1 = x0 + op.width*pxPerIn;
        const headerTh = 10; // px
        const kingColor = '#60a5fa', jackColor = '#a78bfa', headerColor = '#22c55e', sillColor = '#f59e0b', crippleColor = '#fcd34d';

        // King studs (full height) at RO edges
        stud(Math.round(x0), baseY - wallHeightPx, wallHeightPx, kingColor);
        stud(Math.round(x1), baseY - wallHeightPx, wallHeightPx, kingColor);
        studXs.delete(Math.round(x0)); studXs.delete(Math.round(x1));

        // Header + Jacks + Sill/Cripples
        if(op.kind === 'window'){
          const winHpx = op.height * vScale; const sillY = baseY - (op.sill * vScale) - winHpx;
          // RO outline
          const ro = document.createElementNS(svgns,'rect'); ro.setAttribute('x', x0); ro.setAttribute('y', sillY);
          ro.setAttribute('width', (x1-x0)); ro.setAttribute('height', winHpx);
          ro.setAttribute('fill','none'); ro.setAttribute('stroke','#67b7d1'); ro.setAttribute('stroke-width','3'); svg.appendChild(ro);

          // Sill (plate under window)
          const sill = document.createElementNS(svgns,'rect'); sill.setAttribute('x', x0); sill.setAttribute('y', sillY + winHpx);
          sill.setAttribute('width', (x1-x0)); sill.setAttribute('height', 8); sill.setAttribute('fill', sillColor); svg.appendChild(sill);

          // Header above window
          const headerY = sillY - headerTh; const header = document.createElementNS(svgns,'rect');
          header.setAttribute('x', x0); header.setAttribute('y', headerY); header.setAttribute('width', (x1-x0)); header.setAttribute('height', headerTh); header.setAttribute('fill', headerColor); svg.appendChild(header);

          // Jacks up to header
          stud(Math.round(x0)+8, headerY, baseY - headerY, jackColor);
          stud(Math.round(x1)-8, headerY, baseY - headerY, jackColor);

          // Cripple studs above header to top plates @ 16" O.C.
          const startIn = op.from + 16; const endIn = op.from + op.width - 16;
          for(let p=startIn; p<=endIn; p+=16){
            const cx = leftX + p*pxPerIn; if(cx<x0+12 || cx>x1-12) continue;
            const cr = document.createElementNS(svgns,'rect');
            cr.setAttribute('x', cx - 2); cr.setAttribute('y', tp2.getAttribute('y'));
            const h = (headerY - parseFloat(tp2.getAttribute('y')));
            cr.setAttribute('width', 4); cr.setAttribute('height', h);
            cr.setAttribute('fill', crippleColor); svg.appendChild(cr);
          }
        } else if(op.kind === 'door'){
          const dHpx = op.height * vScale; const dY = baseY - dHpx;
          const ro = document.createElementNS(svgns,'rect'); ro.setAttribute('x', x0); ro.setAttribute('y', dY);
          ro.setAttribute('width', (x1-x0)); ro.setAttribute('height', dHpx);
          ro.setAttribute('fill','none'); ro.setAttribute('stroke','#c084fc'); ro.setAttribute('stroke-width','3'); svg.appendChild(ro);

          // Header above door
          const headerY = dY - headerTh; const header = document.createElementNS(svgns,'rect');
          header.setAttribute('x', x0); header.setAttribute('y', headerY); header.setAttribute('width', (x1-x0)); header.setAttribute('height', headerTh); header.setAttribute('fill', headerColor); svg.appendChild(header);

          // Jacks up to header
          stud(Math.round(x0)+8, headerY, baseY - headerY, jackColor);
          stud(Math.round(x1)-8, headerY, baseY - headerY, jackColor);
          // Cripples above header
          const startIn = op.from + 16; const endIn = op.from + op.width - 16;
          for(let p=startIn; p<=endIn; p+=16){
            const cx = leftX + p*pxPerIn; if(cx<x0+12 || cx>x1-12) continue;
            const cr = document.createElementNS(svgns,'rect');
            cr.setAttribute('x', cx - 2); cr.setAttribute('y', tp2.getAttribute('y'));
            const h = (headerY - parseFloat(tp2.getAttribute('y')));
            cr.setAttribute('width', 4); cr.setAttribute('height', h);
            cr.setAttribute('fill', crippleColor); svg.appendChild(cr);
          }
        }
      });

      // After openings, draw regular studs where not occupied by kings (to avoid overlap)
      studXs.forEach(x => {
        // skip if near any opening edge Â±6px
        let skip = false;
        (s.window? [leftX + s.window.from*pxPerIn, leftX + (s.window.from + s.window.width)*pxPerIn] : []).concat(
          s.door? [leftX + (s.door.from==='center'? (s.span/2 - s.door.width/2) : s.door.from)*pxPerIn, leftX + ( (s.door.from==='center'? (s.span/2 - s.door.width/2) : s.door.from) + s.door.width)*pxPerIn ] : []
        ).forEach(edge => { if(Math.abs(x - edge) < 8) skip = true; });
        if(!skip) stud(x, baseY - wallHeightPx, wallHeightPx, '#fbbf24');
      });

      // Anchor bolts visual every 72"
      for(let pos=0; pos<=s.span; pos+=72){
        const cx = leftX + pos*pxPerIn; const c = document.createElementNS(svgns,'circle');
        c.setAttribute('cx', cx); c.setAttribute('cy', baseY); c.setAttribute('r', 3); c.setAttribute('fill', '#ef4444'); svg.appendChild(c);
      }

      // Title
      const title = document.createElementNS(svgns,'text');
      title.setAttribute('x', width/2); title.setAttribute('y', 28); title.setAttribute('fill','#9cc1ff'); title.setAttribute('font-size','18'); title.setAttribute('font-weight','700'); title.setAttribute('text-anchor','middle');
      title.textContent = `${sideKey} Wall â€“ Elevation (16\" O.C., H 8'-0\")`;
      svg.appendChild(title);

      drawRoot.appendChild(svg);
    }

    document.querySelectorAll('.tab').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        drawSide(btn.dataset.side);
      });
    });

    // Initial render
    drawSide('N');
  </script>
</body>
</html>
